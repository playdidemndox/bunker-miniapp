<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ë—É–Ω–∫–µ—Ä: –ü–æ–∫–æ–ª–µ–Ω–∏–µ –ê–ª—å—Ñ–∞</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="/socket.io/socket.io.js"></script>
<base target="_blank">
</head>
<body>
    <div id="app">
        <!-- ==================== –ì–õ–ê–í–ù–´–ô –≠–ö–†–ê–ù ==================== -->
        <div id="main-screen" class="screen active">
            <div class="hero">
                <div class="logo">‚ò¢Ô∏è</div>
                <h1>–ë–£–ù–ö–ï–†</h1>
                <p class="subtitle">–ü–æ–∫–æ–ª–µ–Ω–∏–µ –ê–ª—å—Ñ–∞</p>
                <div class="connection-status" id="connection-status">
                    <span class="indicator connecting"></span>
                    <span class="text">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span>
                </div>
            </div>
            
            <div class="menu-buttons">
                <button class="btn btn-primary" id="btn-create-room" onclick="showScreen('create-room-screen')">
                    <span class="icon">üè†</span>
                    <span>–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</span>
                </button>
                <button class="btn btn-secondary" id="btn-join-room" onclick="showScreen('join-room-screen')">
                    <span class="icon">üîë</span>
                    <span>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</span>
                </button>
                <button class="btn btn-secondary" onclick="showScreen('rules-screen')">
                    <span class="icon">üìñ</span>
                    <span>–ü—Ä–∞–≤–∏–ª–∞</span>
                </button>
            </div>
            
            <div class="game-info">
                <div class="info-item">
                    <span class="icon">üë•</span>
                    <span>4-10 –∏–≥—Ä–æ–∫–æ–≤</span>
                </div>
                <div class="info-item">
                    <span class="icon">‚è±Ô∏è</span>
                    <span>30-60 –º–∏–Ω—É—Ç</span>
                </div>
                <div class="info-item">
                    <span class="icon">üåê</span>
                    <span>–û–Ω–ª–∞–π–Ω</span>
                </div>
            </div>
        </div>

        <!-- ==================== –≠–ö–†–ê–ù –°–û–ó–î–ê–ù–ò–Ø –ö–û–ú–ù–ê–¢–´ ==================== -->
        <div id="create-room-screen" class="screen">
            <div class="header">
                <button class="btn-back" onclick="showScreen('main-screen')">‚Üê</button>
                <h2>–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</h2>
            </div>
            
            <div class="setup-content">
                <div class="setup-section">
                    <h3>–†–µ–∂–∏–º –∏–≥—Ä—ã</h3>
                    <div class="mode-selector">
                        <button class="mode-btn active" data-mode="basic" onclick="selectMode('basic')">
                            <span class="icon">üèÅ</span>
                            <span class="label">–ë–∞–∑–æ–≤—ã–π</span>
                            <span class="desc">–ü–æ–ø–∞–¥–∏ –≤ –±—É–Ω–∫–µ—Ä</span>
                        </button>
                        <button class="mode-btn" data-mode="story" onclick="selectMode('story')">
                            <span class="icon">üìö</span>
                            <span class="label">–ò—Å—Ç–æ—Ä–∏—è –≤—ã–∂–∏–≤–∞–Ω–∏—è</span>
                            <span class="desc">–ü—Ä–µ–æ–¥–æ–ª–µ–π —É–≥—Ä–æ–∑—ã</span>
                        </button>
                    </div>
                </div>
                
                <div class="setup-section">
                    <h3>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤</h3>
                    <div class="players-selector">
                        <button class="players-btn" onclick="changePlayers(-1)">-</button>
                        <span id="players-count" class="players-count">6</span>
                        <button class="players-btn" onclick="changePlayers(1)">+</button>
                    </div>
                    <div class="players-info">
                        <span>–ú–µ—Å—Ç –≤ –±—É–Ω–∫–µ—Ä–µ: <strong id="bunker-slots">3</strong></span>
                        <span>–ë—É–¥–µ—Ç –∏–∑–≥–Ω–∞–Ω–æ: <strong id="exiled-count">3</strong></span>
                    </div>
                </div>
                
                <button class="btn btn-primary btn-large" onclick="createRoom()">
                    <span class="icon">üöÄ</span>
                    <span>–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</span>
                </button>
            </div>
        </div>

        <!-- ==================== –≠–ö–†–ê–ù –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø ==================== -->
        <div id="join-room-screen" class="screen">
            <div class="header">
                <button class="btn-back" onclick="showScreen('main-screen')">‚Üê</button>
                <h2>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</h2>
            </div>
            
            <div class="join-content">
                <div class="code-input-section">
                    <h3>–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã</h3>
                    <div class="code-inputs" id="code-inputs">
                        <input type="text" maxlength="1" class="code-char" data-index="0">
                        <input type="text" maxlength="1" class="code-char" data-index="1">
                        <input type="text" maxlength="1" class="code-char" data-index="2">
                        <input type="text" maxlength="1" class="code-char" data-index="3">
                        <input type="text" maxlength="1" class="code-char" data-index="4">
                        <input type="text" maxlength="1" class="code-char" data-index="5">
                    </div>
                    <p class="hint">–ö–æ–¥ –∏–∑ 6 —Å–∏–º–≤–æ–ª–æ–≤</p>
                </div>
                
                <button class="btn btn-primary btn-large" onclick="joinRoom()">
                    <span class="icon">üö™</span>
                    <span>–í–æ–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É</span>
                </button>
            </div>
        </div>

        <!-- ==================== –≠–ö–†–ê–ù –õ–û–ë–ë–ò (–û–ñ–ò–î–ê–ù–ò–ï) ==================== -->
        <div id="lobby-screen" class="screen">
            <div class="header">
                <button class="btn-back" onclick="leaveRoom()">‚Üê</button>
                <h2>–ö–æ–º–Ω–∞—Ç–∞</h2>
            </div>
            
            <div class="lobby-content">
                <div class="room-code-section">
                    <span class="label">–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã</span>
                    <div class="room-code" id="lobby-room-code">
                        <span class="code">------</span>
                        <button class="btn-copy" onclick="copyRoomCode()">üìã</button>
                    </div>
                    <p class="hint">–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –∫–æ–¥–æ–º —Å –¥—Ä—É–∑—å—è–º–∏</p>
                </div>
                
                <div class="players-section">
                    <h3>–ò–≥—Ä–æ–∫–∏ <span id="players-count-lobby">0/6</span></h3>
                    <div class="lobby-players-list" id="lobby-players">
                        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                    </div>
                </div>
                
                <div class="lobby-info">
                    <div class="info-row">
                        <span>–†–µ–∂–∏–º:</span>
                        <span id="lobby-mode">–ë–∞–∑–æ–≤—ã–π</span>
                    </div>
                    <div class="info-row">
                        <span>–ú–µ—Å—Ç –≤ –±—É–Ω–∫–µ—Ä–µ:</span>
                        <span id="lobby-slots">3</span>
                    </div>
                </div>
                
                <div class="lobby-actions" id="lobby-actions">
                    <button class="btn btn-secondary" id="btn-ready" onclick="toggleReady()">
                        <span class="icon">‚úÖ</span>
                        <span>–ì–æ—Ç–æ–≤</span>
                    </button>
                    <button class="btn btn-primary hidden" id="btn-start-game" onclick="startGame()">
                        <span class="icon">üöÄ</span>
                        <span>–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- ==================== –≠–ö–†–ê–ù –ü–†–ê–í–ò–õ ==================== -->
        <div id="rules-screen" class="screen">
            <div class="header">
                <button class="btn-back" onclick="showScreen('main-screen')">‚Üê</button>
                <h2>–ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</h2>
            </div>
            
            <div class="rules-content">
                <div class="rule-section">
                    <h3>üéØ –¶–µ–ª—å –∏–≥—Ä—ã</h3>
                    <p>–ù–∞ –ó–µ–º–ª–µ –≥—Ä—è–¥—ë—Ç –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞! –í—ã —É –≤—Ö–æ–¥–∞ –≤ —Å–ø–∞—Å–∏—Ç–µ–ª—å–Ω—ã–π –±—É–Ω–∫–µ—Ä, –Ω–æ –º–µ—Å—Ç —Ö–≤–∞—Ç–∏—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –ø–æ–ª–æ–≤–∏–Ω—É. –£–±–µ–¥–∏—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤—ã –¥–æ—Å—Ç–æ–π–Ω—ã –≤—ã–∂–∏—Ç—å.</p>
                </div>
                
                <div class="rule-section">
                    <h3>üÉè –ö–∞—Ä—Ç—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h3>
                    <p>–ö–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç 6 –∫–∞—Ä—Ç: –°—É–ø–µ—Ä—Å–∏–ª–∞, –§–æ–±–∏—è, –•–∞—Ä–∞–∫—Ç–µ—Ä, –•–æ–±–±–∏, –ë–∞–≥–∞–∂ –∏ –§–∞–∫—Ç. –û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –∏—Ö –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å–≤–æ—é –ø–æ–ª–µ–∑–Ω–æ—Å—Ç—å.</p>
                </div>
                
                <div class="rule-section">
                    <h3>üìã –•–æ–¥ –∏–≥—Ä—ã (5 —Ä–∞—É–Ω–¥–æ–≤)</h3>
                    <div class="rounds-table">
                        <div class="round-row header">
                            <span>–†–∞—É–Ω–¥</span>
                            <span>–î–µ–π—Å—Ç–≤–∏–µ</span>
                        </div>
                        <div class="round-row">
                            <span>1</span>
                            <span>–û—Ç–∫—Ä—ã—Ç–∏–µ –°—É–ø–µ—Ä—Å–∏–ª—ã</span>
                        </div>
                        <div class="round-row">
                            <span>2</span>
                            <span>–û—Ç–∫—Ä—ã—Ç–∏–µ 2-–π –∫–∞—Ä—Ç—ã + –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</span>
                        </div>
                        <div class="round-row">
                            <span>3</span>
                            <span>–û—Ç–∫—Ä—ã—Ç–∏–µ 3-–π –∫–∞—Ä—Ç—ã + –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</span>
                        </div>
                        <div class="round-row">
                            <span>4</span>
                            <span>–û—Ç–∫—Ä—ã—Ç–∏–µ 4-–π –∫–∞—Ä—Ç—ã + –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</span>
                        </div>
                        <div class="round-row">
                            <span>5</span>
                            <span>–û—Ç–∫—Ä—ã—Ç–∏–µ 5-–π –∫–∞—Ä—Ç—ã + —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</span>
                        </div>
                    </div>
                </div>
                
                <div class="rule-section">
                    <h3>üó≥Ô∏è –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</h3>
                    <p>–í—Å–µ –∏–≥—Ä–æ–∫–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≥–æ–ª–æ—Å—É—é—Ç –∑–∞ –∏–∑–≥–Ω–∞–Ω–∏–µ. –¢–æ—Ç, –∫—Ç–æ –ø–æ–ª—É—á–∏–ª –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –≥–æ–ª–æ—Å–æ–≤, –ø–æ–∫–∏–¥–∞–µ—Ç –∏–≥—Ä—É. –ü—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ ‚Äî —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä.</p>
                </div>
                
                <div class="rule-section">
                    <h3>üèÜ –ü–æ–±–µ–¥–∞</h3>
                    <p>–í <strong>–ë–∞–∑–æ–≤–æ–º —Ä–µ–∂–∏–º–µ</strong> –ø–æ–±–µ–∂–¥–∞—é—Ç –≤—Å–µ, –∫—Ç–æ –ø–æ–ø–∞–ª –≤ –±—É–Ω–∫–µ—Ä.</p>
                    <p>–í —Ä–µ–∂–∏–º–µ <strong>–ò—Å—Ç–æ—Ä–∏–∏ –≤—ã–∂–∏–≤–∞–Ω–∏—è</strong> –Ω—É–∂–Ω–æ –µ—â—ë –ø—Ä–µ–æ–¥–æ–ª–µ—Ç—å —É–≥—Ä–æ–∑—ã –∏ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—É!</p>
                </div>
            </div>
        </div>

        <!-- ==================== –≠–ö–†–ê–ù –ò–ì–†–´ ==================== -->
        <div id="game-screen" class="screen">
            <div class="game-header">
                <button class="btn-back" onclick="confirmExit()">‚Üê</button>
                <div class="game-info-bar">
                    <span class="round-badge">–†–∞—É–Ω–¥ <span id="current-round">1</span>/5</span>
                    <span class="phase-badge" id="current-phase">–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ</span>
                </div>
            </div>
            
            <div class="catastrophe-banner" id="game-catastrophe">
                <span class="icon">‚ò¢Ô∏è</span>
                <div class="info">
                    <span class="label">–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞</span>
                    <span class="name">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
            </div>
            
            <div class="bunker-threats" id="bunker-threats">
                <div class="bunker-card" id="bunker-card">
                    <span class="label">–ë—É–Ω–∫–µ—Ä</span>
                    <span class="icon">üè†</span>
                    <span class="name">???</span>
                </div>
                <div class="threat-card" id="threat-card">
                    <span class="label">–£–≥—Ä–æ–∑–∞</span>
                    <span class="icon">‚ö†Ô∏è</span>
                    <span class="name">???</span>
                </div>
            </div>
            
            <!-- –ú–æ–∏ –∫–∞—Ä—Ç—ã -->
            <div class="my-cards-section">
                <h3>–ú–æ–∏ –∫–∞—Ä—Ç—ã</h3>
                <div class="my-cards" id="my-cards">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                </div>
            </div>
            
            <!-- –ò–≥—Ä–æ–∫–∏ -->
            <div class="players-section-game">
                <h3>–ò–≥—Ä–æ–∫–∏</h3>
                <div class="game-players-list" id="game-players">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                </div>
            </div>
            
            <!-- –ò–≥—Ä–æ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
            <div class="game-actions" id="game-actions">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
            </div>
        </div>

        <!-- ==================== –≠–ö–†–ê–ù –ì–û–õ–û–°–û–í–ê–ù–ò–Ø ==================== -->
        <div id="voting-screen" class="screen">
            <div class="header">
                <h2>üó≥Ô∏è –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</h2>
                <p class="subtitle">–í—ã–±–µ—Ä–∏—Ç–µ, –∫–æ–≥–æ –∏–∑–≥–Ω–∞—Ç—å</p>
            </div>
            
            <div class="voting-progress" id="voting-progress">
                <span class="progress-text">–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ...</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="voting-progress-fill"></div>
                </div>
            </div>
            
            <div class="voting-players" id="voting-players">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
            </div>
            
            <div class="voting-results hidden" id="voting-results">
                <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
                <div class="results-list" id="results-list"></div>
                <div class="exiled-announcement" id="exiled-announcement"></div>
            </div>
        </div>

        <!-- ==================== –≠–ö–†–ê–ù –§–ò–ù–ê–õ–ê ==================== -->
        <div id="final-screen" class="screen">
            <div class="final-header">
                <h1>üèÜ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞</h1>
            </div>
            
            <div class="final-content" id="final-content">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
            </div>
            
            <div class="final-actions">
                <button class="btn btn-primary" onclick="showScreen('main-screen'); leaveRoom();">
                    <span class="icon">üè†</span>
                    <span>–í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</span>
                </button>
                <button class="btn btn-secondary" onclick="playAgain()">
                    <span class="icon">üîÑ</span>
                    <span>–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</span>
                </button>
            </div>
        </div>

        <!-- ==================== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ==================== -->
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–∞—Ä—Ç—ã -->
        <div id="card-modal" class="modal hidden">
            <div class="modal-content">
                <button class="modal-close" onclick="closeModal()">√ó</button>
                <div class="card-large" id="modal-card"></div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –∫–∞—Ä—Ç—ã –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è -->
        <div id="reveal-modal" class="modal hidden">
            <div class="modal-content">
                <button class="modal-close" onclick="closeRevealModal()">√ó</button>
                <div class="reveal-dialog">
                    <h3>–ö–∞–∫—É—é –∫–∞—Ä—Ç—É –æ—Ç–∫—Ä—ã—Ç—å?</h3>
                    <div class="reveal-options" id="reveal-options"></div>
                </div>
            </div>
        </div>

        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
        <div id="notification" class="notification hidden">
            <span class="icon"></span>
            <span class="message"></span>
        </div>

        <!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
        <div id="loading-overlay" class="loading-overlay hidden">
            <div class="loading-spinner"></div>
            <span class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
